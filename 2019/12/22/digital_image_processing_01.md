T業界に身を置いて早6年が経ち、エンジニア6年生になったわけですが、いわゆるコンピュータサイエンスと言われるコンピュータに関する基礎知識（ストレージ・アルゴリズム・CPUなど）が、最新のクラウドサービスやOSSの性質を読み解く際に必要であることを、最近よく実感しました。
継続的な基礎知識習得のため、このブログを本をベースにインプットした知識をアウトプットしていく場にします。

# はじめに
記念すべき第1回目の記事は[株式会社オープンストリーム Advent Calendar 2019](https://qiita.com/advent-calendar/2019/opst)の22日目の記事となります。
お仕事で某パブリッククラウドの画像検索エンジンを使うことがあるのですが、そもそも画像はどのようにコンピュータに処理されているのかを知りたく、シリーズ「ディジタル画像処理」を始めます。
後述の課題図書に沿って、章ごとのまとめ記事を書いていきます。

# 課題図書
画像処理の仕組みを学ぶため、読み進める本は以下の2つです。「ディジタル画像処理」は画像処理のアルバイトをしていた知人の勧めによるものです。なかなか渋い表紙であり、自身では選択しないであろう良書です。

1. [ディジタル画像処理](https://www.amazon.co.jp/dp/490347450X/)
1. [実践コンピュータビジョン](https://www.amazon.co.jp/dp/4873116074/)

# 画像処理
画像処理とは、画像を入力し、その画像に対してコンピュータが何らかの処理を施すことです。
処理の中には、画像自体の色合いを変えることや、画像から情報を抽出することも含まれます。
特に、入力された2次元の画像から元の3次元の情報を復元する処理は、コンピュータビジョンと呼ばれることが多いです。課題図書の「実践コンピュータビジョン」は画像処理全般を扱っています。

# 画像のディジタル化
#### アナログ画像とディジタル画像
画像には色の濃さや色合い、物体の反射光などの光強度情報が含まれています。
アナログ情報である光強度情報を、コンピュータが扱えるディジタル信号に変換するためには、離散的な位置にある光強度を数値化する処理を行います。同位置にあるアナログ情報を取り出す処理を**標本化**といいます。標本化は波形を細かく短冊切りにし、短冊ごとの高さを取得するイメージです。有限分解能の数値に変換する処理を**量子化**といいます。量子化は短冊の高さを近似させ、高さを扱い易くするイメージです。

#### 画像の標本化
画像における標本化では、2次元のアナログ情報である画像を等間隔の格子状に区切った標本点から光強度を取り出します。標本点は**画素**または**ピクセル**と呼ばれます。標本点が多ければ多いほど、アナログ情報である画像の再現性が高まりますが、ご存知の通り、画素が多いほど画像サイズが大きくなります。
標本化間隔（＝短冊の長さ）を元の波形の周期の1/2以下で標本化すれば、元の画像を再現することができます。これを**シャノンの標本化定理**といい、シャノンの標本化定理を満たす最大の標本化間隔を**ナイキスト間隔**といいます。元の波形の周期の1/2より大きい値で標本化すると、元の信号とは異なる偽信号が現れます。この現象を**エイリアシング**といいます。以下に元の信号を青色、標本化された信号を赤色で示した図を載せます。ナイキスト間隔は共に180であり、ナイキスト間隔図の標本化間隔は180で、エイリアシング図の標本化間隔は300です。ナイキスト間隔図は青色線と赤色線が近しい値を取っていますが、エイリアシング図では、青色線と赤色線が異なり、偽信号が観測されていることがわかります。

- ナイキスト間隔図
![undefined.jpg](https://s3.qrunch.io/513ddb17f16dd83d5f52dcc9e1d7158e.png)
- エイリアシング図
![undefined.jpg](https://s3.qrunch.io/4ed139b7720e71b6937c15e899562242.png)

#### 画像の量子化
量子化後の画素の値を**画素値**といいます。画素値が取りうる範囲が256段階(0~255)の時を**8ビット量子化**といい、1024段階(0~1023)の時を**10ビット量子化**といい、段階数を量子化レベルといいます。量子化レベル数が大きいほど、細かな変化が表現できます。白と黒だけの量子化レベル数が2であるディジタル画像を**2値画像**といい、それ以上の量子化レベル数の画像を**グレースケール画像**といいます。グレースケール画像は、画像中の位置に対応する画素値が明るさに関する情報のみを保持しているのに対し、同位置でRGBのそれぞれの画素値を持っている画像を**RGBカラー画像**といいます。RGBカラー画像は、RGB各色の画素値を現す3枚のグレースケール画像から構成されていると考えることができ、各色ごとに256段階(8ビット＝1バイト)あるため、グレースケール画像の3倍のデータサイズになります。

# 限定色表示
入力画像が持つ色数を出力可能な色数に調節して出力することを**限定色表示**といいます。

#### 均等量子化法
限定色表示の最も簡易な方法として、RGB空間を均等なセルに分割し、入力画像の各画素を現す色が含まれるセルの代表色を表示色とする方法を、**均等量子化法**といいます。

#### 頻度法
均等量子化法では画像に含まれる色の出現頻度によらず、色を割り当てているため、画像を再現できていないと捉えられることが多いです。そこで、入力画像のカラーヒストグラム(＝画素値の出現頻度)をRGB空間で算出し、カラーヒストグラムのピークに近い値を優先的に表示色として決定することで、画像の再現性を高める方法、**頻度法**が誕生しました。

# ハーフトーニング
白と黒の2値のパターンの疎密によって、濃淡を表現する方法をハーフトーニングといいます。
濃い色部分は黒が密集していて、薄い色は白が密集しているイメージです。2値画像では白か黒かの2択のみであるため、灰色を表現できないことが同方法の誕生理由です。
また、ハーフトーニングにより、グレースケール画像を表現することを**擬似濃淡表示**といいます。

# まとめ
アナログ情報である画像を定量的なディジタルデータに変換する方法を学ぶことができました。
次回は「画像生成モデル」を学びます。
#### おわび
某パブリッククラウドの資格試験が目前に迫っていることもあり、アドベントカレンダー執筆がギリギリになってしまいました。
